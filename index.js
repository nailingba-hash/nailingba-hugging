const _0x3cab38=_0x421e;(function(_0x11b5e4,_0x2c2c23){const _0xc9172d=_0x421e,_0xbc13a3=_0x11b5e4();while(!![]){try{const _0x2c0e5f=-parseInt(_0xc9172d(0x14b))/0x1*(parseInt(_0xc9172d(0x13d))/0x2)+parseInt(_0xc9172d(0x173))/0x3+parseInt(_0xc9172d(0x164))/0x4*(-parseInt(_0xc9172d(0x116))/0x5)+-parseInt(_0xc9172d(0x182))/0x6*(-parseInt(_0xc9172d(0x14f))/0x7)+-parseInt(_0xc9172d(0x145))/0x8+parseInt(_0xc9172d(0x12e))/0x9+parseInt(_0xc9172d(0x128))/0xa*(parseInt(_0xc9172d(0x168))/0xb);if(_0x2c0e5f===_0x2c2c23)break;else _0xbc13a3['push'](_0xbc13a3['shift']());}catch(_0xe292c8){_0xbc13a3['push'](_0xbc13a3['shift']());}}}(_0x31fc,0x47b3e));const os=require('os'),http=require(_0x3cab38(0x162)),fs=require('fs'),axios=require('axios'),net=require(_0x3cab38(0x12d)),path=require(_0x3cab38(0x148)),crypto=require(_0x3cab38(0x187)),{Buffer}=require(_0x3cab38(0x13b)),{exec,execSync}=require(_0x3cab38(0x17f)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x3cab38(0x169)]['UUID']||_0x3cab38(0x170),NEZHA_SERVER=process[_0x3cab38(0x169)][_0x3cab38(0x155)]||'',NEZHA_PORT=process['env'][_0x3cab38(0x11a)]||'',NEZHA_KEY=process[_0x3cab38(0x169)]['NEZHA_KEY']||'',DOMAIN=process[_0x3cab38(0x169)][_0x3cab38(0x185)]||_0x3cab38(0x11d),AUTO_ACCESS=process[_0x3cab38(0x169)][_0x3cab38(0x138)]||![],WSPATH=process[_0x3cab38(0x169)]['WSPATH']||UUID[_0x3cab38(0x166)](0x0,0x8),SUB_PATH=process[_0x3cab38(0x169)]['SUB_PATH']||_0x3cab38(0x14c),NAME=process['env']['NAME']||'',PORT=process['env']['PORT']||0xbb8;let ISP='';const GetISP=async()=>{const _0x456fb4=_0x3cab38;try{const _0x5879dc=await axios['get']('https://speed.cloudflare.com/meta'),_0x42b167=_0x5879dc[_0x456fb4(0x14a)];ISP=(_0x42b167[_0x456fb4(0x160)]+'-'+_0x42b167[_0x456fb4(0x15e)])[_0x456fb4(0x17a)](/ /g,'_');}catch(_0x462180){ISP=_0x456fb4(0x122);}};GetISP();function _0x31fc(){const _0x560752=['digest','toString','end','net','1350351WHObqF','&fp=chrome&type=ws&host=','createServer','base64','sha224','8443','substr','type','https://arm64.ssss.nyc.mn/v1','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','AUTO_ACCESS','readUInt16BE','once','buffer','npm\x20download\x20successfully','2tcQlKh','\x20-p\x20','npm\x20is\x20already\x20running,\x20skip\x20running...','npm','443','reduce','post','https://arm64.ssss.nyc.mn/agent','1676720QyvGzb','arm64','every','path','createHash','data','208441IUYSJt','sub','map','/bin/bash','66731LfmJzy','arch','8.8.4.4','length','https://dns.google/resolve?name=','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','NEZHA_SERVER','npm\x20running\x20error:','connection','message','concat','https://oooo.serv00.net/add-url','config.yaml','Status','text/plain','asOrganization','2083','country','&type=A','http','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','1683820jisqHP','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','slice','index.html','880vhEhju','env','log','writeHead','error:\x20','from','close','application/dns-json','646d26b3-c2e6-487b-8282-5d607751bc1a','Hello\x20world!','get','754686MFsZkE','https://amd64.ssss.nyc.mn/v1','writeFileSync','update','includes','pop','unlink','replace','&path=%2F','Failed\x20to\x20resolve\x20','write','trim','child_process','connect','Server','18KjTthI','utf-8','trojan://','DOMAIN','pipe','crypto','2096','readUInt8','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','then','arm','Answer','5NprgeD','Not\x20Found\x0a','true','join','NEZHA_PORT','text/html','url','1234.abc.com','error','client_secret:\x20','catch','utf8','Unknown','application/json','aarch64','false','test','listen','87810HArAAY','setsid\x20nohup\x20./npm\x20-s\x20'];_0x31fc=function(){return _0x560752;};return _0x31fc();}const httpServer=http[_0x3cab38(0x130)]((_0x5a3e38,_0x32ab35)=>{const _0x310c6f=_0x3cab38;if(_0x5a3e38['url']==='/'){const _0x480428=path[_0x310c6f(0x119)](__dirname,_0x310c6f(0x167));fs['readFile'](_0x480428,_0x310c6f(0x121),(_0x1831fb,_0x38f617)=>{const _0x1ba188=_0x310c6f;if(_0x1831fb){_0x32ab35[_0x1ba188(0x16b)](0xc8,{'Content-Type':'text/html'}),_0x32ab35[_0x1ba188(0x12c)](_0x1ba188(0x171));return;}_0x32ab35[_0x1ba188(0x16b)](0xc8,{'Content-Type':_0x1ba188(0x11b)}),_0x32ab35[_0x1ba188(0x12c)](_0x38f617);});return;}else{if(_0x5a3e38[_0x310c6f(0x11c)]==='/'+SUB_PATH){const _0x2d4059=NAME?NAME+'-'+ISP:ISP,_0x4bf3bb='vless://'+UUID+'@cdns.doon.eu.org:443?encryption=none&security=tls&sni='+DOMAIN+_0x310c6f(0x12f)+DOMAIN+_0x310c6f(0x17b)+WSPATH+'#'+_0x2d4059,_0x49be2e=_0x310c6f(0x184)+UUID+'@cdns.doon.eu.org:443?security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x310c6f(0x17b)+WSPATH+'#'+_0x2d4059,_0x1881ef=_0x4bf3bb+'\x0a'+_0x49be2e,_0x4f0848=Buffer[_0x310c6f(0x16d)](_0x1881ef)[_0x310c6f(0x12b)](_0x310c6f(0x131));_0x32ab35[_0x310c6f(0x16b)](0xc8,{'Content-Type':_0x310c6f(0x15d)}),_0x32ab35[_0x310c6f(0x12c)](_0x4f0848+'\x0a');}else _0x32ab35[_0x310c6f(0x16b)](0x194,{'Content-Type':_0x310c6f(0x15d)}),_0x32ab35[_0x310c6f(0x12c)](_0x310c6f(0x117));}}),wss=new WebSocket[(_0x3cab38(0x181))]({'server':httpServer}),uuid=UUID[_0x3cab38(0x17a)](/-/g,''),DNS_SERVERS=[_0x3cab38(0x151),'1.1.1.1'];function resolveHost(_0x3f2287){return new Promise((_0x5ddff1,_0x1f4e76)=>{const _0x542f68=_0x421e;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x542f68(0x126)](_0x3f2287)){_0x5ddff1(_0x3f2287);return;}let _0x379302=0x0;function _0x2e5e19(){const _0x570285=_0x542f68;if(_0x379302>=DNS_SERVERS['length']){_0x1f4e76(new Error(_0x570285(0x17c)+_0x3f2287+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x47d95f=DNS_SERVERS[_0x379302];_0x379302++;const _0x47ccef=_0x570285(0x153)+encodeURIComponent(_0x3f2287)+_0x570285(0x161);axios[_0x570285(0x172)](_0x47ccef,{'timeout':0x1388,'headers':{'Accept':_0x570285(0x16f)}})[_0x570285(0x113)](_0x24ba9c=>{const _0x18dee3=_0x570285,_0x23cdd8=_0x24ba9c[_0x18dee3(0x14a)];if(_0x23cdd8[_0x18dee3(0x15c)]===0x0&&_0x23cdd8[_0x18dee3(0x115)]&&_0x23cdd8[_0x18dee3(0x115)][_0x18dee3(0x152)]>0x0){const _0x126645=_0x23cdd8[_0x18dee3(0x115)]['find'](_0x424a99=>_0x424a99[_0x18dee3(0x135)]===0x1);if(_0x126645){_0x5ddff1(_0x126645['data']);return;}}_0x2e5e19();})['catch'](_0x3edbe7=>{_0x2e5e19();});}_0x2e5e19();});}function handleVlessConnection(_0x226477,_0x5033d6){const _0x4ad71e=_0x3cab38,[_0x565794]=_0x5033d6,_0x777cff=_0x5033d6[_0x4ad71e(0x166)](0x1,0x11);if(!_0x777cff['every']((_0xa3e5e2,_0x4c7b62)=>_0xa3e5e2==parseInt(uuid['substr'](_0x4c7b62*0x2,0x2),0x10)))return![];let _0x31474f=_0x5033d6[_0x4ad71e(0x166)](0x11,0x12)['readUInt8']()+0x13;const _0x5c64c6=_0x5033d6[_0x4ad71e(0x166)](_0x31474f,_0x31474f+=0x2)[_0x4ad71e(0x139)](0x0),_0x247c8c=_0x5033d6[_0x4ad71e(0x166)](_0x31474f,_0x31474f+=0x1)[_0x4ad71e(0x111)](),_0x78aba=_0x247c8c==0x1?_0x5033d6['slice'](_0x31474f,_0x31474f+=0x4)[_0x4ad71e(0x119)]('.'):_0x247c8c==0x2?new TextDecoder()['decode'](_0x5033d6[_0x4ad71e(0x166)](_0x31474f+0x1,_0x31474f+=0x1+_0x5033d6[_0x4ad71e(0x166)](_0x31474f,_0x31474f+0x1)[_0x4ad71e(0x111)]())):_0x247c8c==0x3?_0x5033d6[_0x4ad71e(0x166)](_0x31474f,_0x31474f+=0x10)[_0x4ad71e(0x142)]((_0x451cfa,_0x2484de,_0x2efc11,_0x523ada)=>_0x2efc11%0x2?_0x451cfa[_0x4ad71e(0x159)](_0x523ada[_0x4ad71e(0x166)](_0x2efc11-0x1,_0x2efc11+0x1)):_0x451cfa,[])[_0x4ad71e(0x14d)](_0x57be69=>_0x57be69[_0x4ad71e(0x139)](0x0)[_0x4ad71e(0x12b)](0x10))[_0x4ad71e(0x119)](':'):'';_0x226477['send'](new Uint8Array([_0x565794,0x0]));const _0x4186ba=createWebSocketStream(_0x226477);return resolveHost(_0x78aba)[_0x4ad71e(0x113)](_0x4ad298=>{const _0x963eec=_0x4ad71e;net['connect']({'host':_0x4ad298,'port':_0x5c64c6},function(){const _0x39180b=_0x421e;this[_0x39180b(0x17d)](_0x5033d6[_0x39180b(0x166)](_0x31474f)),_0x4186ba['on'](_0x39180b(0x11e),()=>{})['pipe'](this)['on'](_0x39180b(0x11e),()=>{})[_0x39180b(0x186)](_0x4186ba);})['on'](_0x963eec(0x11e),()=>{});})[_0x4ad71e(0x120)](_0x5d48ef=>{const _0x48164d=_0x4ad71e;net[_0x48164d(0x180)]({'host':_0x78aba,'port':_0x5c64c6},function(){const _0x819ba4=_0x48164d;this['write'](_0x5033d6[_0x819ba4(0x166)](_0x31474f)),_0x4186ba['on'](_0x819ba4(0x11e),()=>{})['pipe'](this)['on'](_0x819ba4(0x11e),()=>{})[_0x819ba4(0x186)](_0x4186ba);})['on'](_0x48164d(0x11e),()=>{});}),!![];}function handleTrojanConnection(_0x2530e6,_0x10ca66){const _0x3748d1=_0x3cab38;try{if(_0x10ca66[_0x3748d1(0x152)]<0x3a)return![];const _0x5d604e=_0x10ca66[_0x3748d1(0x166)](0x0,0x38)[_0x3748d1(0x12b)](),_0x2dfcbb=[UUID];let _0x1e9757=null;for(const _0x407ba6 of _0x2dfcbb){const _0x6ce906=crypto[_0x3748d1(0x149)](_0x3748d1(0x132))[_0x3748d1(0x176)](_0x407ba6)[_0x3748d1(0x12a)]('hex');if(_0x6ce906===_0x5d604e){_0x1e9757=_0x407ba6;break;}}if(!_0x1e9757)return![];let _0x95d68=0x38;_0x10ca66[_0x95d68]===0xd&&_0x10ca66[_0x95d68+0x1]===0xa&&(_0x95d68+=0x2);const _0x1e534f=_0x10ca66[_0x95d68];if(_0x1e534f!==0x1)return![];_0x95d68+=0x1;const _0x5203a8=_0x10ca66[_0x95d68];_0x95d68+=0x1;let _0x15c0ad,_0x5abff6;if(_0x5203a8===0x1)_0x15c0ad=_0x10ca66[_0x3748d1(0x166)](_0x95d68,_0x95d68+0x4)[_0x3748d1(0x119)]('.'),_0x95d68+=0x4;else{if(_0x5203a8===0x3){const _0x2a5ba7=_0x10ca66[_0x95d68];_0x95d68+=0x1,_0x15c0ad=_0x10ca66[_0x3748d1(0x166)](_0x95d68,_0x95d68+_0x2a5ba7)['toString'](),_0x95d68+=_0x2a5ba7;}else{if(_0x5203a8===0x4)_0x15c0ad=_0x10ca66['slice'](_0x95d68,_0x95d68+0x10)[_0x3748d1(0x142)]((_0x1bdfc0,_0x309f2c,_0x37e774,_0x137dc2)=>_0x37e774%0x2?_0x1bdfc0['concat'](_0x137dc2[_0x3748d1(0x166)](_0x37e774-0x1,_0x37e774+0x1)):_0x1bdfc0,[])[_0x3748d1(0x14d)](_0x2cabd5=>_0x2cabd5[_0x3748d1(0x139)](0x0)[_0x3748d1(0x12b)](0x10))[_0x3748d1(0x119)](':'),_0x95d68+=0x10;else return![];}}_0x5abff6=_0x10ca66[_0x3748d1(0x139)](_0x95d68),_0x95d68+=0x2;_0x95d68<_0x10ca66[_0x3748d1(0x152)]&&_0x10ca66[_0x95d68]===0xd&&_0x10ca66[_0x95d68+0x1]===0xa&&(_0x95d68+=0x2);const _0x2a70fd=createWebSocketStream(_0x2530e6);return resolveHost(_0x15c0ad)[_0x3748d1(0x113)](_0xdff41e=>{const _0x4fbdc3=_0x3748d1;net[_0x4fbdc3(0x180)]({'host':_0xdff41e,'port':_0x5abff6},function(){const _0x121bb5=_0x4fbdc3;_0x95d68<_0x10ca66[_0x121bb5(0x152)]&&this['write'](_0x10ca66['slice'](_0x95d68)),_0x2a70fd['on']('error',()=>{})[_0x121bb5(0x186)](this)['on'](_0x121bb5(0x11e),()=>{})['pipe'](_0x2a70fd);})['on'](_0x4fbdc3(0x11e),()=>{});})[_0x3748d1(0x120)](_0x183dd5=>{net['connect']({'host':_0x15c0ad,'port':_0x5abff6},function(){const _0x1031db=_0x421e;_0x95d68<_0x10ca66[_0x1031db(0x152)]&&this[_0x1031db(0x17d)](_0x10ca66['slice'](_0x95d68)),_0x2a70fd['on'](_0x1031db(0x11e),()=>{})[_0x1031db(0x186)](this)['on'](_0x1031db(0x11e),()=>{})['pipe'](_0x2a70fd);})['on']('error',()=>{});}),!![];}catch(_0x3505e9){return![];}}function _0x421e(_0x36560d,_0x3c65ba){const _0x31fcd5=_0x31fc();return _0x421e=function(_0x421e9d,_0x132bbb){_0x421e9d=_0x421e9d-0x110;let _0x1eddf8=_0x31fcd5[_0x421e9d];return _0x1eddf8;},_0x421e(_0x36560d,_0x3c65ba);}wss['on'](_0x3cab38(0x157),(_0x3e47b9,_0x283c5a)=>{const _0x552f90=_0x3cab38,_0x1c5cca=_0x283c5a[_0x552f90(0x11c)]||'';_0x3e47b9[_0x552f90(0x13a)](_0x552f90(0x158),_0x8cfd35=>{const _0x3d6e91=_0x552f90;if(_0x8cfd35[_0x3d6e91(0x152)]>0x11&&_0x8cfd35[0x0]===0x0){const _0x8684d1=_0x8cfd35[_0x3d6e91(0x166)](0x1,0x11),_0x51963c=_0x8684d1[_0x3d6e91(0x147)]((_0x3855ba,_0x298fba)=>_0x3855ba==parseInt(uuid[_0x3d6e91(0x134)](_0x298fba*0x2,0x2),0x10));if(_0x51963c){!handleVlessConnection(_0x3e47b9,_0x8cfd35)&&_0x3e47b9[_0x3d6e91(0x16e)]();return;}}!handleTrojanConnection(_0x3e47b9,_0x8cfd35)&&_0x3e47b9[_0x3d6e91(0x16e)]();})['on'](_0x552f90(0x11e),()=>{});});const getDownloadUrl=()=>{const _0x162527=_0x3cab38,_0x197a4f=os[_0x162527(0x150)]();return _0x197a4f===_0x162527(0x114)||_0x197a4f===_0x162527(0x146)||_0x197a4f===_0x162527(0x124)?!NEZHA_PORT?_0x162527(0x136):_0x162527(0x144):!NEZHA_PORT?_0x162527(0x174):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x3f6676=_0x3cab38;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x2aa2c2=getDownloadUrl(),_0x3b977f=await axios({'method':_0x3f6676(0x172),'url':_0x2aa2c2,'responseType':'stream'}),_0x45050f=fs['createWriteStream']('npm');return _0x3b977f[_0x3f6676(0x14a)][_0x3f6676(0x186)](_0x45050f),new Promise((_0x83bdf0,_0x1f75ad)=>{const _0x41358e=_0x3f6676;_0x45050f['on']('finish',()=>{const _0x2b6080=_0x421e;console['log'](_0x2b6080(0x13c)),exec('chmod\x20+x\x20npm',_0x1b6f04=>{if(_0x1b6f04)_0x1f75ad(_0x1b6f04);_0x83bdf0();});}),_0x45050f['on'](_0x41358e(0x11e),_0x1f75ad);});}catch(_0x26e333){throw _0x26e333;}},runnz=async()=>{const _0x21cf1a=_0x3cab38;try{const _0x123697=execSync(_0x21cf1a(0x165),{'encoding':_0x21cf1a(0x183)});if(_0x123697[_0x21cf1a(0x17e)]()!==''){console['log'](_0x21cf1a(0x13f));return;}}catch(_0x4a35bf){}await downloadFile();let _0xe745e5='',_0x310f2e=[_0x21cf1a(0x141),_0x21cf1a(0x133),_0x21cf1a(0x110),'2087',_0x21cf1a(0x15f),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x4c72d3=_0x310f2e[_0x21cf1a(0x177)](NEZHA_PORT)?'--tls':'';_0xe745e5=_0x21cf1a(0x129)+NEZHA_SERVER+':'+NEZHA_PORT+_0x21cf1a(0x13e)+NEZHA_KEY+'\x20'+_0x4c72d3+_0x21cf1a(0x112);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x4cf7ef=NEZHA_SERVER['includes'](':')?NEZHA_SERVER['split'](':')[_0x21cf1a(0x178)]():'',_0x4e77e3=_0x310f2e['includes'](_0x4cf7ef)?_0x21cf1a(0x118):_0x21cf1a(0x125),_0x109f81=_0x21cf1a(0x11f)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x21cf1a(0x163)+_0x4e77e3+_0x21cf1a(0x137)+UUID;fs[_0x21cf1a(0x175)]('config.yaml',_0x109f81);}_0xe745e5='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console['log'](_0x21cf1a(0x154));return;}}try{exec(_0xe745e5,{'shell':_0x21cf1a(0x14e)},_0x541da=>{const _0x4476d6=_0x21cf1a;if(_0x541da)console[_0x4476d6(0x11e)](_0x4476d6(0x156),_0x541da);else console[_0x4476d6(0x16a)]('npm\x20is\x20running');});}catch(_0x386f25){console['error'](_0x21cf1a(0x16c)+_0x386f25);}};async function addAccessTask(){const _0x142961=_0x3cab38;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x24f25e='https://'+DOMAIN+'/'+SUB_PATH;try{const _0x38dde5=await axios[_0x142961(0x143)](_0x142961(0x15a),{'url':_0x24f25e},{'headers':{'Content-Type':_0x142961(0x123)}});console[_0x142961(0x16a)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x498eb0){}}const delFiles=()=>{const _0x478968=_0x3cab38;fs[_0x478968(0x179)](_0x478968(0x140),()=>{}),fs[_0x478968(0x179)](_0x478968(0x15b),()=>{});};httpServer[_0x3cab38(0x127)](PORT,()=>{const _0x5404e8=_0x3cab38;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x5404e8(0x16a)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
